\chapter{Conclusions}
\label{chap:conclusions-future-work}

This research was motivated by a desire to obtain Monte Carlo (MC) quality solutions with computationally efficient deterministic neutron transport methods. This thesis approached this objective by employing continuous energy \ac{MC} neutron transport simulations to generate accurate  multi-group cross sections (MGXS) for fine-mesh deterministic transport codes. The new methods developed in this thesis were designed to accelerate the convergence of \ac{MGXS} tallied on full-core, fine-spatial meshes by leveraging the phenomenon of pin-wise \ac{MGXS} clustering. These methods reduce the computational burden of \ac{MC}-based \ac{MGXS} generation techniques, positioning it as a reactor agnostic alternative to today's deterministic methods which rely on engineering approximations.

This chapter concludes by evaluating the results presented in this thesis with respect to this over-arching objective, and by defining a roadmap of the milestones which must be addressed in the future to design a production-ready methodology for \ac{MC}-based reactor agnostic fine-mesh \ac{MGXS} generation. The key results demonstrated by this thesis are discussed in Sec.~\ref{sec:chap12-conclusions}, the author's contributions to the field of reactor physics are outlined in Sec.~\ref{sec:chap12-contributions}, and opportunities for future research are summarized in Sec.~\ref{sec:chap12-future-work}.

%-notes from bryan's thesis conclusions
%  -conclusions
%    -first sentence: something that i did
%    -remaining sentences: summarize / quantify conclusions
%    -final sentence: what does it all mean / impact statement
%  -future work
%    -break up into multiple sections
%    -first sentence: problem / approximation
%    -remaining sentences: how this impacted my results
%    -final sentence: possible solutions  

%-look at my executive summary - perhaps include a one-page summary of bullets???

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary of Work}
\label{sec:chap12-conclusions}

This thesis replaces the traditional multi-level framework used for \ac{MGXS} generation with a single full-core MC calculation, as summarized in Sec.~\ref{subsec:chap12-single-step}. Sec.~\ref{subsec:chap12-approx-error} highlights results which quantify different sources of approximation error in multi-group methods with \ac{MGXS} generated by \ac{MC}. The clustering of pin-wise \ac{MGXS} due to spatial self-shielding effects is recapped in Sec.~\ref{subsec:chap12-mgxs-clustering}. Finally, Sec.~\ref{subsec:chap12-homogenization-schemes} reviews the performance of new pin-wise spatial homogenization schemes which model \ac{MGXS} clustering.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{A Single-Step Approach for MGXS Generation}
\label{subsec:chap12-single-step}

Today's state-of-the-art methods for \ac{MGXS} generation use a multi-level approach in space, energy and angle to account for self-shielding effects while approximating the flux used to collapse cross sections (see Sec.~\ref{subsec:chap2-mgxs-lib-std-approach}). The flux approximations used in multi-level schemes are based on engineering prescriptions for specific reactor configurations and spectra and are not easily generalizable to new core designs. In addition, \ac{MC}-based \ac{MGXS} generation methods to date have retained the multi-level geometric framework to tabulate MGXS for individual reactor components for subsequent use in full-core multi-group calculations. Although the use of MC within a multi-level scheme eliminates the need to approximate the flux in energy, it does not account for spatial self-shielding effects throughout a reactor core. This thesis replaces the multi-level framework with a full-core \ac{MC} calculation that simultaneously accounts for all energy and spatial effects with a single simulation of the complete heterogeneous geometry.

This work required the development of a ``simulation triad'' encompassing three primary simulation codes. The OpenMC Monte Carlo code was utilized to generate multi-group cross sections on high-spatial-fidelity tally meshes. Second, the OpenMOC code used \ac{MGXS} for deterministic multi-group transport calculations. Finally, the OpenCG library enabled the processing and transfer of tally data on combinatorial geometry meshes between OpenMC and OpenMOC. The simulation triad directly modeled all energy and spatial self-shielding effects with a single full-core OpenMC calculation of the complete heterogeneous geometry to generate \ac{MGXS} for use in OpenMOC.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Approximation Error in Multi-Group Methods}
\label{subsec:chap12-approx-error}

This thesis investigated approximation error present in multi-group solutions even when the ``true'' flux from \ac{MC} is used to collapse cross sections for \ac{MGXS} generation. The case studies presented in Chap.~\ref{chap:biases} quantified the eigenvalue bias between OpenMC and OpenMOC by separately varying the angular discretization, flat source region discretization and energy group structure while holding all other variables constant. A systematic bias on the order of -300 \ac{pcm} was demonstrated for a representative 2D \ac{PWR} fuel pin cell with converged angular and spatial discretization schemes and 70-group cross sections. The iso-in-lab scattering feature was employed in OpenMC to enable direct comparisons with OpenMOC which assumes an isotropic scattering source, but this only mitigated the bias by approximately 100 \ac{pcm}. The remaining -200 \ac{pcm} was shown to be caused by over-predictions of U-238 capture rates in resonance energy groups. As the energy group structures were refined, the errors were magnified for those energy groups encompassing the three lowest lying U-238 capture resonances.

%-Surprisingly, the bias grew in magnitude (but decreased in value) with more energy groups.
%-the eigenvalue bias varied substantially with the \ac{FSR} discretization, but was invariant to the spatial tally mesh used to generate \ac{MGXS}. 
%-largest for interior zones of fuel pin, smallest for outer rim of fuel pin nearest to the clad/moderator

In collaboration with Gibson~\cite{gibson2016thesis}, the U-238 capture rate errors and resulting eigenvalue bias were demonstrated to be the result of the flux separability approximation (Sec.~\ref{subsec:chap2-angle}) which permits the use of constant-in-angle \ac{MGXS}. In particular, it was shown that the flux separability approximation is not generally valid for U-238 capture since the angular neutron flux leaving a fuel pin is much more self-shielded in resonance groups than it is for the neutron flux entering the fuel pin from the moderator. Since the angular dependence of \ac{MGXS} is not typically modeled in deterministic multi-group transport codes, an equivalence scheme is needed to correct for the loss of angular information when cross sections are collapsed with the scalar rather than the angular flux. 

Chap.~\ref{chap:sph} explored the use of SuPerHomog\'{e}n\'{e}isation (SPH) factors as one possible equivalence scheme to enforce reaction rate preservation between OpenMC and OpenMOC. The \ac{SPH} factor approach uses a reference fixed source to correct the total \ac{MGXS} to preserve reaction rates between fine and coarse mesh methods. The \ac{SPH} factors systematically eliminated the few percent reaction rate errors in U-238 resonance groups, and correspondingly reduced the eigenvalue bias from -200 \ac{pcm} to approximately 10 \ac{pcm}. In particular, the \ac{SPH} factors reduced the total \ac{MGXS} in resonance groups by 1 -- 3\% to resolve errors of the same magnitude in each of the lowest lying U-238 capture resonance groups. Notwithstanding these results, it is unclear if a generalizable scheme based upon \ac{SPH} factors may be used to correct for the flux separability approximation. Future work should further investigate equivalence methods which adequately preserve reaction rates in fine-mesh transport methods with \ac{MC}-generated \ac{MGXS}.

%-depending on energy group structure and \ac{FSR} discretization

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Clustering of Pin-Wise MGXS}
\label{subsec:chap12-mgxs-clustering}

This thesis explored the dispersion and clustering of pin-wise \ac{MGXS} due to the spatial self-shielding spectral effects in heterogeneous single assembly benchmarks, 2$\times$2 assembly colorsets and a quarter core model of the \ac{BEAVRS} \ac{PWR} geometry. The results in Chap.~\ref{chap:spatial} demonstrated that the population variance of pin-wise \ac{MGXS} increases with the introduction of geometric heterogeneities such as control rod guide tubes (CRGTs), burnable poisons (BPs) and water reflectors. The magnitude of the dispersion depended on the sensitivity of each nuclide, reaction type and energy group to spatial self-shielding effects. Furthermore, the distributions of pin-wise \ac{MGXS} plotted as histograms illustrated the clustering of \ac{MGXS} in fuel pins with similar neighboring heterogeneities, and hence similar spatially self-shielded flux spectra. Although U-235 thermal fission \ac{MGXS} exhibited more clearly defined clusters than U-238 capture \ac{MGXS}, the U-238 capture \ac{MGXS} varied by up to 1.8\% about the population mean while U-235 fission \ac{MGXS} varied by only 1.2\% about the mean. These results indicate that \ac{MGXS} clustering is more challenging to identify but more important to model for accurate U-238 capture rates than for U-235 fission rates.

%The distributions of pin-wise \ac{MGXS} were highly dependent on the specific reactor configuration.

This thesis performed a series of case studies to investigate the impact of modeling (or neglecting) the clustering of pin-wise \ac{MGXS} due to spatial self-shielding effects\footnote{Although all spatial zones may experience spatial self-shielding, this thesis specifically modeled the impact of spatial self-shielding on MGXS in fissile materials.}. The null and degenerate pin-wise spatial homogenization schemes were designed to quantify the magnitude of the approximation error in deterministic methods that can be resolved by accounting for \ac{MGXS} clustering. Both schemes use a single \ac{MC} calculation of the complete heterogeneous geometry to collapse MGXS with the ``true'' flux. Null homogenization simply assigns all fuel pins to the same \ac{MGXS} cluster and averages all spatial self-shielding effects across the entire geometry. The null scheme makes no effort to account for spatial self-shielding effects experienced by different fuel pins, and computes a single \ac{MGXS} for each fuel enrichment. Degenerate spatial homogenization takes the opposite approach and assigns each fuel pin its own \ac{MGXS}, and is equivalent to modeling each fuel pin as a unique \ac{MGXS} cluster. The degenerate scheme accounts for all spatial self-shielding effects experienced by each instance of each fuel pin throughout a heterogeneous geometry. Although degenerate homogenization is more accurate than null homogenization, it requires many more \ac{MC} particle histories to converge the uncertainties on the \ac{MGXS} tallied separately for each fuel pin.

A series of OpenMOC simulations were performed in Chap.~\ref{chap:quantify} with 70-group \ac{MGXS} libraries prepared by the null and degenerate spatial homogenization schemes for six heterogeneous \ac{PWR} benchmarks to measure the impact of \ac{MGXS} clustering on deterministic calculations. In each case, the OpenMOC eigenvalue, pin-wise fission rate and U-238 capture rate predictions were compared with reference OpenMC results\footnote{The case studies were performed for 2-, 8- and 70-group cross sections. The results cited in this chapter correspond to the 70-group calculations since the fine group structure was necessary to resolve OpenMOC's U-238 capture rate predictions to within 2\% of the reference OpenMC results. }. The OpenMOC eigenvalues were within 100 -- 250 \ac{pcm} of the reference OpenMC eigenvalues for all six benchmarks. More importantly, the effect of \ac{MGXS} clustering had no impact on the eigenvalue predictions since null and degenerate homogenization use the same \ac{MC} flux to collapse the cross sections and therefore preserve global reaction rates. The effects of \ac{MGXS} clustering only marginally impacted the OpenMOC fission rates errors which were <2\% for all six benchmarks\footnote{The degenerate homogenization fission rate errors were 5 -- 20\% less than those for null homogenization.}.

The U-238 capture rate errors were much more sensitive to \ac{MGXS} clustering than the fission rates. The degenerate homogenization scheme reduced the errors by 2 -- 4$\times$ with respect to the null scheme for each of the single assembly and colorset benchmarks, approaching the same error magnitude as that observed for the fission rates. The errors for the null scheme were largest for fuel pins near control rode guide tubes and along inter-assembly and assembly-reflector interfaces. The degenerate homogenization scheme reduced the errors for these pins since it accounts for spatial self-shielding spectral effects, such as the additional moderation provided by neighboring control rod guide tubes and/or water reflectors. These results indicate that the U-238 capture rate errors in deterministic multi-group calculations of \acp{PWR} are largely dominated by the approximation(s) made to model pin-wise \ac{MGXS} clustering.

A large fraction of the fissions that occur in \ac{LWR} fuel at the end-of-life occur in the Pu-239 that is bred from U-238 capture reactions. As a result, accurate, high-spatial-fidelity fission rate predictions are limited by the accuracy of the U-238 capture rate predictions in burn-up calculations. The results presented in this thesis underscore the importance of modeling \ac{MGXS} clustering in order to predict Pu-239 production and therefore fission rates over time. This is important not only for \acp{LWR}, but also for advanced reactor concepts that are designed to convert sizable amounts of U-238 to Pu-239 for consumption. In general, \ac{MGXS} clustering is important to model in reactors with a complex configuration of absorbing (\textit{e.g.}, control) and/or moderating materials and relatively short neutron mean free paths (\textit{i.e.}, thermal reactors) such that geometric heterogeneities shield the localized flux throughout the reactor.

%\footnote{\ac{MGXS} clustering may be less important for fast spectrum reactors with large neutron mean free paths since the local flux is relatively insensitive to spatial self-shielding spectral effects.}.

%In particular, \ac{MGXS} clustering is an important phenomenon to model for advanced reactors with relatively short neutron mean free paths (\textit{i.e.}, thermal reactors) such that geometric heterogeneities shield the localized flux to varying degrees throughout the reactor.

%These results are important since U-238 capture rates must be accurately calculated to predict Pu-239 production over time. 

%-degenerate scheme ``smooths'' U-238 capture rates (i.e., reduces largest errors)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Pin-Wise Spatial Homogenization Schemes}
\label{subsec:chap12-homogenization-schemes}

Although the degenerate scheme greatly reduces U-238 capture rate errors by accounting for \ac{MGXS} clustering, it is computationally expensive to converge the \ac{MC} tallies since the particle track densities in each spatial tally zone is quite small. This thesis developed two new pin-wise spatial homogenization schemes which aim to strike a balance between accuracy and computational efficiency by accounting for \ac{MGXS} clustering to accelerate the convergence of the \ac{MGXS} tallies in each fine-spatial-mesh tally zone. The two new schemes are motivated by the idea that fuel pins with similar neighboring heterogeneities will have similar microscopic \ac{MGXS}. In particular, these schemes aim to approach the accuracy of the degenerate scheme by accounting for spatial self-shielding effects, while simultaneously approaching the \ac{MC} convergence of the null scheme by homogenizing over as many spatial tally zones (\textit{i.e.}, fuel pins) as possible.

%-need to homogenize across many fuel pins to reduce the MGXS statistical uncertainties and batchwise deviations

This thesis proposes both engineering-based clustering and statistical clustering methods to accelerate the convergence of full-core \ac{MC} calculations for \ac{MGXS} generation. Local Neighbor Symmetry (LNS) spatial homogenization (Chap.~\ref{chap:spatial}) is an engineering-based approach which clusters \ac{MGXS} based on a nearest neighbor analysis of the fuel pins in a combinatorial geometry. The \ac{LNS} scheme is akin to geometric templates employed by some lattice physics codes to predict which groupings of fuel pins are likely to experience similar spatial self-shielding effects and hence have similar \ac{MGXS}. The MGXS are homogenized from ``noisy'' \ac{MC} tally data across all pins within the same \ac{LNS} grouping. Inferential \ac{MGXS} (\textit{i}\ac{MGXS}) spatial homogenization (Chap.~\ref{chap:unsupervised}) uses statistical clustering algorithms to infer \ac{MGXS} clusters directly from ``noisy'' \ac{MC} tally data. Unlike the \ac{LNS} scheme, the \textit{i}\ac{MGXS} has no knowledge of a reactor's geometric or materials configuration and instead relies on unsupervised machine learning techniques to determine which fuel pins to cluster in spatial homogenization zones. The \textit{i}\ac{MGXS} scheme is a multi-stage data processing pipeline and includes feature extraction, feature selection, dimensionality reduction, predictor training, model selection and spatial homogenization stages. Both \ac{LNS} and \textit{i}\ac{MGXS} homogenization schemes attempt to model \ac{MGXS} clustering with fewer materials than degenerate homogenization in order to accelerate the \ac{MC} tally convergence rate by homogenizing \ac{MGXS} across many fuel pins.

%The \textit{i}\ac{MGXS} scheme can flexibly accommodate arbitrary core heterogeneities better than heuristic approaches like \ac{LNS} which must be customized for particular core geometries. In addition, the \textit{i}\ac{MGXS} scheme accelerates the convergence rate of MGXS tallied with MC with respect to the degenerate and \ac{LNS} schemes since it homogenizes MC tallies across many more fuel pins.

% However, the \ac{LNS} algorithm fails to predict spatial self-shielding effects in arbitrary core geometries, such as those that occur at assembly-assembly and assembly-reflector interfaces. These shortcomings motivate the need for an unsupervised approach to accurately and scalably predict MGXS clustering.

The efficacy of the \ac{LNS} and \textit{i}\ac{MGXS} schemes to identify \ac{MGXS} clusters was evaluated for each of the six heterogeneous \ac{PWR} benchmarks. The ``clustered geometries'' for the \ac{LNS} scheme illustrate the method's ability to distinguish fuel pins with neighboring \acp{CRGT} and/or \acp{BP}, but its inability to distinguish fuel pins at the interfaces with neighboring assemblies, reflectors or baffles. In contrast, the \textit{i}\ac{MGXS} scheme distinguished pins with similar neighboring \acp{CRGT} and/or \acp{BP}, and subsequently distinguished pins along interfaces into unique clusters. In general, the clustered geometries indicate that \textit{i}\ac{MGXS} scheme can flexibly accommodate arbitrary core heterogeneities better than heuristic approaches like \ac{LNS} which must be customized for particular core geometries.

A series of OpenMOC simulations were performed with \ac{MGXS} libraries prepared by the \ac{LNS} (Chap.~\ref{chap:spatial}) and \textit{i}\ac{MGXS} (Chap.~\ref{chap:results}) spatial homogenization schemes. As expected, the eigenvalues predicted by both schemes were nearly identical (to within 10 \ac{pcm}) since both schemes preserve global reaction rates. Although fission rates are only marginally impacted by \ac{MGXS} clustering, the predictions with the \ac{LNS} and \textit{i}\ac{MGXS} schemes were very nearly as accurate as those for the degenerate scheme. Most importantly, the U-238 capture rate errors approached those for the degenerate scheme to varying degrees for both schemes. The \ac{LNS} scheme performed as well the degenerate scheme for the single assembly benchmarks, but failed to systematically reduce the largest errors in the pins along inter-assembly and assembly-reflector interfaces. The \textit{i}\ac{MGXS} scheme largely reduced the U-238 capture rate errors with just a few clusters with relatively diminishing returns for more clusters. The \textit{i}\ac{MGXS} scheme required more materials (\textit{i.e.}, clusters) than \ac{LNS} to achieve the same accuracy for single assembly benchmarks. However, \textit{i}\ac{MGXS} outperformed \ac{LNS} for those benchmarks with inter-assembly and assembly-reflector interfaces, since it assigned unique \ac{MGXS} to the fuel pins along the interfaces to account for the local spatially self-shielded flux spectra.

%The convergence analysis was performed for the single assembly and 2$\times$2 colorset benchmarks, but was not performed for the quarter core \ac{BEAVRS} model due to computational constraints.

In addition, the simulations were performed to quantify the number of \ac{MC} particle histories required to sufficiently converge the \ac{MGXS} for stable OpenMOC solutions with each pin-wise spatial homogenization scheme. The eigenvalues for the null, degenerate, \ac{LNS} and \textit{i}\ac{MGXS} schemes converged to the same value with approximately 10$^{8}$ particle histories. As expected, the pin-wise U-238 capture rates converged in accordance with the number of clusters used in each pin-wise spatial homogenization scheme. In particular, the capture rates for the null scheme quickly converged with only 10$^{6}$ histories, but were still not yet fully converged for degenerate homogenization even with 10$^{9}$ histories. In contrast, the \ac{LNS} and \textit{i}\ac{MGXS} schemes converged faster than the degenerate scheme since they averaged the \ac{MGXS} tallied for the pins assigned to each cluster. Furthermore, both schemes converged faster than the statistical uncertainties of the corresponding reference OpenMC calculation. The magnitude of the acceleration achieved by both schemes depends on both the number of clusters required to meet the desired level of accuracy, as well as the number of fuel pins assigned to each cluster\footnote{The error convergence is limited by the number of pins assigned to the smallest \ac{MGXS} cluster. The pins adjacent to the baffle/reflector -- which exhibited the largest U-238 capture rate errors -- comprised the smallest clusters in each benchmark and were the most limiting to the overall convergence.}. The mean capture rate rate errors converged 4 -- 30$\times$ faster than the degenerate scheme and 2 -- 10$\times$ faster than the OpenMC reference solution uncertainties for the benchmarks considered in this thesis.

%, though more histories may be needed for larger geometries (\textit{e.g.}, \ac{BEAVRS})

% -but with so few pins assigned to the cluster, the track density and therefore acceleration is minimal
% The eigenvalues fluctuated within 500 \ac{pcm} of the converged mean for fewer histories.

These results demonstrate a path forward to generate \ac{MGXS} with reactor agnostic \ac{MC} for computationally efficient deterministic transport codes. This thesis replaced traditional multi-level \ac{MGXS} generation schemes with \ac{MC} calculations of the complete heterogeneous geometry to generate reactor agnostic \ac{MGXS} in a single step. Engineering-based and statistical clustering algorithms were developed to model the clustering of pin-wise \ac{MGXS} to reduce the U-238 capture rate errors while simultaneously accelerating the convergence of the tallied \ac{MGXS}. The \ac{LNS} and \textit{i}\ac{MGXS} schemes enabled deterministic reactor physics simulations to produce accurate results from \ac{MGXS} generated by \ac{MC} faster than would be possible with a direct calculation with \ac{MC}. Furthermore, the \textit{i}\ac{MGXS} scheme was shown to be advantageous over geometric heuristic approaches such as \ac{LNS} which must be highly customized for specific types of core geometries.

%  -\ac{LNS} requires 400+ of materials to model 12,000+ fuel pin instances in \ac{BEAVRS}
%    -analysis of geometry is based on cell/universe/lattice IDs

%-iMGXS accounts for spatial self-shielding spectral effects without engineering heuristics based on the reactor core configuration.

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Contributions}
\label{sec:chap12-contributions}

%-itemize which approximation errors were investigated
%  -MOC: angular discretization, \ac{FSR} discretization, energy discretization
%  -MGXS: isotropic in lab approximation, energy discretization, spatial homogenization zones (by FSR within each pin, across many ``clustered pins'')

%\item Developed \ac{LNS} and \textit{i}\ac{MGXS} pin-wise spatial homogenization schemes to account for spatial self-shielding effects on the \ac{MGXS} in each fuel pin while simultaneously accelerating \ac{MC} tally convergence.

\begin{emphbox}
\begin{itemize}
\item Generated \ac{MGXS} with a single \ac{MC} simulation of a complete heterogeneous reactor geometry for use in fine-mesh deterministic transport calculations.
\item Implemented a simulation triad that generated \ac{MGXS} with OpenMC, used \ac{MGXS} in deterministic OpenMOC calculations, and transferred \ac{MGXS} between codes and built clustered geometries with OpenCG.
\item Explored \ac{SPH} factors as an equivalence scheme between continuous energy \ac{MC} and multi-group \ac{MOC} methods and to correct for approximation error resulting from constant-in-angle \ac{MGXS}.
\item Developed pin-wise spatial homogenization schemes to model spatial self-shielding for each fuel pin with varying degrees of granularity and complexity while simultaneously accelerating \ac{MC} tally convergence:
\begin{itemize}
%  \item Null homogenization treats all fuel pins of a given enrichment with the same \ac{MGXS}.
%  \item Degenerate homogenization assigns a unique \ac{MGXS} to each fuel pin within a reactor.
  \item Local Neighbor Symmetry (LNS) homogenization uses a nearest neighbor-like analysis of a combinatorial geometry to predict which fuel pins will experience similar spatial self-shielding effects.
  \item Inferential \ac{MGXS} (\textit{i}\ac{MGXS}) homogenization uses unsupervised statistical clustering algorithms to predict \ac{MGXS} clustering from ``noisy'' \ac{MC} tally data without any knowledge of the reactor geometry.
\end{itemize}
\item Quantified approximation error between reference OpenMC and deterministic OpenMOC calculations of the eigenvalues, pin-wise fission rates and U-238 capture rates for each homogenization scheme.
\item Demonstrated that \ac{LNS} and \textit{i}\ac{MGXS} spatial homogenization schemes are credible paths to generate very accurate \ac{MGXS} and require fewer \ac{MC} histories to generate \ac{MGXS} and to converge deterministic calculations to a given accuracy than an equivalent \ac{MC} calculation.
\end{itemize}
\end{emphbox}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Future Work}
\label{sec:chap12-future-work}

This thesis identified several issues which must be investigated in the future to position single-step \ac{MC} simulations as a practical alternative to traditional multi-level \ac{MGXS} generation techniques. The following sections itemize the author's assessment of the most important outstanding issues and the order in which they should be addressed. Sec.~\ref{subsec:chap12-further-imgxs} discusses case studies which should be performed to optimize and to evaluate the performance of the \textit{i}\ac{MGXS} spatial homogenization scheme. Sec.~\ref{subsec:chap12-improve-mc-methods} highlights several key shortcomings in the present approach to generate \ac{MGXS} with \ac{MC} which must be confronted to resolve lingering sources of approximation error between continuous energy \ac{MC} and deterministic multi-group methods.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Further Evaluation of the \textit{i}MGXS Scheme}
\label{subsec:chap12-further-imgxs}

A number of challenges must be addressed in the future in order for \textit{i}\ac{MGXS} to be useful in a production code setting. Sec.~\ref{subsubsec:chap12-imgxs-noisy-mc-data} discusses the need for future studies to determine the number of particle histories required to accurately identify \ac{MGXS} clusters from ``noisy'' \ac{MC} tally data. Sec.~\ref{subsubsec:chap12-optimize-imgxs} outlines the many remaining challenges to optimize the various stages of the \textit{i}\ac{MGXS} data processing pipeline. Sec.~\ref{subsubsec:chap12-optimize-simulation-triad} highlights issues which must be resolved to enable fast and reliable calculations with the simulation triad of OpenMC, OpenMOC and OpenCG.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Noisy Tally Data and the \textit{i}MGXS Scheme}
\label{subsubsec:chap12-imgxs-noisy-mc-data}

The case studies in Sec.~\ref{sec:chap11-converge} investigated the number of \ac{MC} particle histories required to sufficiently converge \ac{MGXS} tallied by OpenMC for stable deterministic solutions with OpenMOC. Each of the studies used ``fully converged'' \ac{MC} tally data to train a clustering model, which was then repeatedly used to cluster fuel pins for spatial homogenization with ``noisier'' \ac{MC} tally data. This was a useful exercise since it provided a lower bound on how quickly \ac{MGXS} would converge if a formulation of the \textit{i}\ac{MGXS} pipeline is devised in the future that can accurately identify clusters from ``noisy'' \ac{MC} tally data. However, these results did not adequately gauge the number of \ac{MC} particle histories required to stabilize the OpenMOC solutions with \textit{i}\ac{MGXS} in a production-like setting.

Future convergence studies should train clustering models with the ``noisy'' MC tally data for each statepoint from an OpenMC simulation to determine how quickly the clustering predictions converge. Based on this author's preliminary studies, a larger fraction of fuel pins are assigned to the ``wrong'' \ac{MGXS} clusters when the clustering models are trained with ``noisy'' \ac{MC} tally data. As a result, it is reasonable to expect that the approximation error between OpenMOC and the reference OpenMC solutions will be larger than that observed in Sec.~\ref{sec:chap11-converge} when relatively few particle histories are used to generate \ac{MGXS}. However, given enough particle histories, the approximation errors should approach the converged values presented in Sec.~\ref{sec:chap11-converge}. The results from future convergence studies should be used to improve the estimates for the expected runtimes for OpenMOC simulations with \textit{i}\ac{MGXS} in Sec.~\ref{subsec:chap11-runtimes}.

%  -wouldn't reduce but could potentially increase the runtime estimates
%  -also possible that clustering predictions ``converge'' or ``stabilize'' before the OpenMOC solutions
%-should also perform convergence studies with BEAVRS full core

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{\textit{i}MGXS Data Processing Pipeline Configuration}
\label{subsubsec:chap12-optimize-imgxs}

There is a plethora of opportunities to optimize the performance of the \textit{i}\ac{MGXS} spatial homogenization scheme. This thesis tested only but a few of the many different possible machine learning algorithms that may be interchangeably used within the \textit{i}\ac{MGXS} data processing pipeline. Future work should systematically evaluate various configurations of the pipeline and score each by the number of \ac{MC} histories needed to accurately identify \ac{MGXS} clusters from ``noisy'' \ac{MC} tally data. The feature extraction stage (Sec.~\ref{sec:chap10-feature-extract}) may be improved with the development of new \ac{MC} tallies, or combinations of tallies, to be used as features which may indicate the existence of \ac{MGXS} clustering with fewer particle histories than the features introduced in this thesis. New techniques should be evaluated for the feature selection stage (Sec.~\ref{sec:chap10-feature-select}) to identify those features most useful for clustering analysis. The dimensionality reduction stage (Sec.~\ref{sec:chap10-dimension-reduce}) should be a key focal point of future work to determine how to extract latent information from highly correlated features and to reduce the number of features used in clustering analysis\footnote{Although the clustered geometries produced with three different dimensionality reduction techniques are briefly compared in App.~\ref{sec:clustering-with-dimension-reduce}, dimensionality reduction was not used by the \textit{i}\ac{MGXS} pipeline for the simulation results presented in Chap.~\ref{chap:results}.}. Future efforts may explore different clustering algorithms -- and optimize the parameters for each with cross-validation -- for the predictor training stage (Sec.~\ref{sec:chap10-train-predictor}). The performance of each clustering algorithm should be scored according to the number of clusters required to reduce the U-238 capture rate errors in OpenMOC. Finally, future work should identify one or more heuristics to reliably determine the most appropriate number of clusters\footnote{None of the model selection techniques evaluated in Sec.~\ref{sec:chap11-model-select} performed as expected except for the Bayesian Information Criterion, which showed some promise as a means to select the number of components for Gaussian Mixture Models.} for the model selection stage (Sec.~\ref{sec:chap10-model-select}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Computational Performance of the Simulation Triad}
\label{subsubsec:chap12-optimize-simulation-triad}

The analysis of the quarter core \ac{BEAVRS} model in Chaps.~\Crefrange{chap:quantify}{chap:results} was limited by some computational bottlenecks that must be resolved to enable practical and reliable full-core calculations with the simulation triad (Chap.~\ref{chap:workflow}). First and foremost, a quarter pin mesh was required to guarantee stable solutions for the \ac{BEAVRS} model with OpenMOC's implementation of Coarse Mesh Finite Difference (CMFD) acceleration, which greatly increased the runtime of each simulation. Future work should improve the stability of \ac{CMFD} in OpenMOC for coarser meshes (\textit{e.g.}, quarter assembly meshes) and optimize the computational efficiency of the \ac{CMFD} implementation overall. A linear source approximation (instead of a flat source approximation) would greatly reduce the number of discretized spatial zones, likewise reducing both the runtime and memory footprint for OpenMOC simulations. Furthermore, the computational efficiency of the transport solver in OpenMOC would be greatly improved with the use of Single Instruction, Multiple Data (SIMD) vectorization over energy groups. In addition to improving OpenMOC's computational efficiency, the performance of the OpenMC code may be improved in the future. As noted in Tab.~\ref{table:chap11-openmc-rates}, the per-core particle tracking rates for OpenMC were 3 -- 4$\times$ slower with tallies. This performance degradation may be mitigated in the future with spatial domain decomposition~\cite{horelik2014dd}, tally servers~\cite{romano2013servers}, and/or SIMD vectorization of the tallying algorithms in OpenMC.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Improve Methods to Generate MGXS with MC}
\label{subsec:chap12-improve-mc-methods}

This thesis identified several areas which must be addressed in order to make \ac{MC}-based \ac{MGXS} generation methods practical for fine-mesh transport codes. Sec.~\ref{subsubsec:chap12-tally-estimators} presents the need for new statistical estimators to improve the tally efficiency of multi-group scattering matrices. As discussed in Sec.~\ref{subsubsec:chap12-transport-mgxs}, new methods must be developed to compute transport-corrected \ac{MGXS} with \ac{MC} which account for anisotropic scattering, thereby eliminating the isotropic in lab scattering approximations used throughout this thesis. Sec.~\ref{subsubsec:chap12-angular-dependent-mgxs} motivates the need for an equivalence method to enforce reaction rate preservation between continuous energy \ac{MC} and multi-group deterministic methods with scalar flux-weighted \ac{MGXS}. Finally, future work should consider employing \ac{MC} to generate \ac{MGXS} for multi-physics applications as highlighted in Sec.~\ref{subsubsec:chap12-multi-physics-mgxs}.

%The deficiencies which should be addressed may be measured along two primary dimensions:

%\begin{itemize}[noitemsep]
%\item Improve the Monte Carlo tallying efficiency of multi-group cross sections
%\item Reduce approximation error between continuous energy \ac{MC} and multi-group deterministic methods
%\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Statistical Efficiencies of Tally Estimators}
\label{subsubsec:chap12-tally-estimators}

This thesis generated \ac{MGXS} using a mixture of track-length and analog tally estimators as described in Sec.~\ref{subsubsec:chap3-tally-types-summary}. Track-length estimators were used for reaction rate and flux tallies which depend on the incoming neutron energy (\textit{e.g.}, total, fission), while less efficient analog estimators were necessary for tallies with an outgoing energy dependence, including those used to compute multi-group scattering matrices and fission emission spectra. Although the expectation of track-length and analog statistical estimates are identical, the variance is typically much larger for the analog estimates for a given number of particle histories. As a result, the \ac{MGXS} tallied with a mixture of track-length and analog estimators will not preserve neutron balance without a sufficient number of particle histories. This was observed in Sec.~\ref{subsec:chap11-eigenvalue-converge} where the eigenvalue estimates for different pin-wise spatial homogenization schemes only converged to the same value after 10$^{8}$ particle histories were simulated. Future work may rectify this by designing a more statistically efficient tally estimator for multi-group scattering matrices and fission spectra. Nelson developed a theoretically rigorous methodology for this purpose in~\cite{nelson2014improved}, though a simple heuristic to simultaneously tally to multiple outgoing energy bins in scattering collisions may be sufficient for hydrogenous reactor systems.

%The separation between the eigenvalues for each scheme with few simulated particle histories is likely due to the mixture of track-length and analog tally estimators. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Tally Estimators for Transport-Corrected MGXS}
\label{subsubsec:chap12-transport-mgxs}

This thesis implemented a feature to use isotropic in lab (``iso-in-lab'') scattering in OpenMC to enable direct comparisons with OpenMOC which uses an isotropic scattering source. Isotropic scattering is generally not a valid approximation for nuclear reactors as is vividly evident by comparing the pin-wise fission and U-238 capture rates for \ac{BEAVRS} modeled in OpenMC with iso-in-lab scattering (Figs.~\ref{fig:chap7-fiss-rates-full-core} and~\ref{fig:chap7-capt-rates-full-core}) and anisotropic scattering (Fig.~\ref{fig:benchmarks-beavrs-aniso})\footnote{The fission and capture rates are much more highly peaked in the assemblies near the periphery of the core since more neutrons scatter back into the reactor from the reflector with the iso-in-lab approximation. The reaction rate distributions are flatter when modeled with anisotropic scattering since more neutons leak from the core.}. Future work should account for anisotropic scattering in deterministic multi-group calculations with \ac{MGXS} generated by \ac{MC}. The most theoretically rigorous approach would model a truncated form of the Legendre moment expansion of the scattering kernel (Sec.~\ref{subsec:chap2-scatt-src}) as is done in many deterministic transport codes today. This approach requires the use of multi-group scattering matrix Legendre moments which may be computed using the \texttt{openc.mgxs} module. However, a model of the scattering moments does increase the computational complexity for deterministic codes.

A common alternative is to use a transport correction to the total \ac{MGXS} and scattering matrix (Sec.~\ref{subsec:chap2-transport-corr}). Future work may aim to develop and validate methods to model transport corrections for \ac{MGXS} generated from \ac{MC} tallies. The work by Liu~\cite{liuphysor2016} to tally diffusion coefficients without approximation in \ac{MC} may be extended to develop a reliable method to tally transport-corrected \ac{MGXS} in \ac{MC}. The development of an improved transport-corrected \ac{MGXS} tally estimator may not only account for the effects of anisotropic scattering, but also make it possible to employ reduced energy group structures without sacrificing accuracy. Group condensation studies should be considered in the future to determine if it is possible to maintain a high-level of accuracy with fewer energy groups with transport-corrected \ac{MGXS}.

%-unclear what expansion order is necessary
% -more expensive to 1) compute scattering source and 2) tally flux moments
% -modify the total cross section in an attempt to produce an equivalent solution 
%  -advantage is that the computational burden is no larger than it is currently

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Equivalence Methods for Angular-Dependent MGXS}
\label{subsubsec:chap12-angular-dependent-mgxs}

The results in Chap.~\ref{chap:biases} demonstrated how constant-in-angle \ac{MGXS} leads to U-238 capture rate errors in resonance groups, resulting in a few hundred \ac{pcm} eigenvalue bias for a simple \ac{PWR} pin cell problem\footnote{It is also likely that the flux separability approximation was a dominant factor in the <2\% pin-wise fission and U-238 capture rate errors which remained even with the use of highly accurate degenerate spatial homogenization (Chap.~\ref{chap:spatial}), though this was not definitively proven in this thesis.}. Chap.~\ref{chap:sph} successfully used \ac{SPH} factors as an equivalence scheme to correct for the approximation error resulting from the use of the angular rather than the scalar flux to collapse cross sections. However, the \ac{SPH} factor approach suffers from a number of shortcomings (Sec.~\ref{sec:chap6-sph-shortcomings}) and it is unclear whether it may be broadly applied to correct for the flux separability approximation in \ac{MGXS} generated from \ac{MC}. In particular, the \ac{SPH} factor method is complicated by the need to compute a reference fixed source with \ac{MC} for the spatial discretization mesh used in multi-group methods. In addition, \ac{SPH} factors do not simply correct for the error due to the flux separability approximation, but instead indiscriminately correct for all sources of approximation error between \ac{MC} and multi-group methods.

As a result, new equivalence schemes should be explored in the future to specifically correct for the flux separability approximation in arbitrarily discretized geometries. For example, the angular dependence of the total \ac{MGXS} may be adequately embedded into the scattering kernel using the Consistent-P approximation~\cite{bell1967transport} (also known as the BHS approximation). Alternatively, a coarse set of angular-dependent \ac{MGXS} may mitigate most of the approximation error observed between continuous energy \ac{MC} and deterministic multi-group methods. For example, a simple approximation might model two different total \ac{MGXS} for neutrons entering or leaving a fuel pin. Although such a coarse angular scheme would not capture the high degree of angular variation of \ac{MGXS}, it might capture enough to adequately reduce the integrated error\footnote{Recent work by Gibson~\cite{gibson2016thesis} showed that the use of finely discretized angular-dependent \ac{MGXS} very nearly eliminated the error in resonance groups resulting from the flux separability approximation.}. 

%One challenge to this approach would be to define a general way to accommodate different spatial discretizations, which is highly coupled to the \ac{MGXS} angular dependence of the \ac{MGXS}.

% -SPH is iterative and hence computationally expensive
%  -possible changes: may be able to tabulate a set of \ac{SPH} factors
%     -for a specific group structure and spatial discretization
%  -unclear how much the factors depend on enrichment, spatial discretization, etc.

%-angular-dependent \ac{MGXS}
%  -why it is challenging:
%    -burdensome to track extra data in deterministic code
%    -burdensome to tally extra data in \ac{MC}
%    -must \textit{a priori} know or approximate angular dependence and its relationship with spatial mesh
%  -possible changes: ``jump'' conditions, i.e. coarse angular discretization
%    -still requires some knowledge of spatial discretization mesh

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Multi-Physics Feedback in MGXS}
\label{subsubsec:chap12-multi-physics-mgxs}

This thesis performed steady-state calculations of \ac{PWR} benchmarks with fresh fuel at hot zero power conditions. Future work should build upon the progress made in this thesis to generate \ac{MGXS} with \ac{MC} for multi-physics applications. Further development of the \textit{i}\ac{MGXS} scheme may account for thermal-hydraulic feedback in which fuel temperature and moderator density gradients are modeled in \ac{MC} calculations for \ac{MGXS} generation. For example, \ac{MC} calculations performed using Doppler broadened cross sections sampled on-the-fly with the windowed multipole method in OpenMC~\cite{forget2014direct} to generate \ac{MGXS} which accurately reflect the distribution of fuel temperatures across a reactor core. The extensions of the \textit{i}\ac{MGXS} scheme would be most useful if developed in conjunction with an extension of the simulation framework from two to three dimensions. In addition, \ac{MC} may be used to generate \ac{MGXS} for deterministic codes at each burnup step in a depletion calculation with the appropriate isotopic vectors modeled in each fuel pin. Furthermore, future work should consider using the \textit{i}\ac{MGXS} scheme in calculations with thermal-hydraulic feedback and nuclide depletion where the moderator density, fuel temperature and burnup may be used as features to predict MGXS clustering. Indeed, it may be valuable to expand upon this thesis' dependence on clustering algorithms and instead use multivariate regression models (\textit{e.g.}, decision tree regressors) to predict continuously varying \ac{MGXS} based on features such as fuel temperature and burnup\footnote{Regression models may pose a challenge since continuously varying \ac{MGXS} predictions will not preserve global reactivity, which is guaranteed by simple(r) discrete predictions from clustering models used to compute track density-weighted average \ac{MGXS} (Sec.~\ref{subsec:chap9-lns-math}) in this thesis.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Inspiration for New Research Directions}
\label{subsec:chap12-inspiration}

The \textit{i}\ac{MGXS} scheme uses unsupervised statistical clustering methods to replace engineering-based approximations or heuristics with data-informed decision-making to cluster \ac{MGXS} for pin-wise spatial homogenization. This thesis may inspire the future application of machine learning to closely related issues, such as automating the selection of energy group boundaries for \ac{MGXS} generation. However, it is this author's opinion that \ac{MGXS} clustering is only one of many potential applications for which machine learning may be used to improve the accuracy and speed of numerical simulations. The scientific computing community has an increasingly vast array of machine learning algorithms at its disposal which may be used to automate the tedious and error prone process of parameter selection. Only the sky is the limit when it comes to harnessing the power of machine learning in the service of advanced computational physics simulation.

%    -more flexible/extensible and accurate for parameter regimes (i.e., reactor designs) for which there may be little prior experience / heuristics