\chapter{Conclusions}
\label{chap:conclusions-future-work}

This research was motivated by a desire to obtain Monte Carlo-quality solutions with computationally efficient deterministic neutron transport methods. This thesis approached this objective by employing continuous energy \ac{MC} neutron transport simulations to generate accurate \ac{MGXS} for fine-mesh deterministic transport codes. The new methods developed in this thesis were designed to accelerate the convergence of \ac{MGXS} tallied on full-core, fine-spatial meshes by leveraging the phenomenon of pin-wise \ac{MGXS} clustering. These methods reduce the computational burden of \ac{MC}-based \ac{MGXS} generation techniques, positioning it as a reactor agnostic alternative to today's deterministic methods which rely on engineering approximations.

This chapter concludes by evaluating the results presented in this thesis with respect to this over-arching objective, and by defining a roadmap of the milestones which must be addressed in the future to design a production-ready methodology for \ac{MC}-based reactor agnostic fine-mesh \ac{MGXS} generation. The key results demonstrated by this thesis are discussed in Sec.~\ref{sec:chap12-conclusions}, the author's contributions to the field of reactor physics are outlined in Sec.~\ref{sec:chap12-contributions}, and opportunities for future research are summarized in Sec.~\ref{sec:chap12-future-work}.

%-notes from bryan's thesis conclusions
%  -conclusions
%    -first sentence: something that i did
%    -remaining sentences: summarize / quantify conclusions
%    -final sentence: what does it all mean / impact statement
%  -future work
%    -break up into multiple sections
%    -first sentence: problem / approximation
%    -remaining sentences: how this impacted my results
%    -final sentence: possible solutions  

%-look at my executive summary - perhaps include a one-page summary of bullets???

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary of Work}
\label{sec:chap12-conclusions}

This thesis replaces the traditional multi-level framework used for \ac{MGXS} generation with a single full-core MC calculation as summarized in Sec.~\ref{subsec:chap12-single-step}. Sec.~\ref{subsec:chap12-approx-error} highlights results which quantify different sources of approximation error in multi-group methods with \ac{MGXS} generated by \ac{MC}. The clustering of pin-wise \ac{MGXS} due to spatial self-shielding effects is recapped in Sec.~\ref{subsec:chap12-mgxs-clustering}. Finally, Sec.~\ref{subsec:chap12-homogenization-schemes} reviews the performance of new pin-wise spatial homogenization schemes which model \ac{MGXS} clustering.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{A Single-Step Approach for MGXS Generation}
\label{subsec:chap12-single-step}

Today's state-of-the-art methods for \ac{MGXS} generation use a multi-level approach in space, energy and angle to account for self-shielding effects while approximating the flux used to collapse cross sections (see Sec.~\ref{subsec:chap2-mgxs-lib-std-approach}). The flux approximations used in multi-level schemes are based on engineering prescriptions for specific reactor configurations and spectra and are not generalizable to new core designs. In addition, \ac{MC}-based \ac{MGXS} generation methods to date have retained the multi-level geometric framework to tabulate MGXS for individual reactor components for subsequent use in full-core multi-group calculations. Although the use of MC within a multi-level scheme eliminates the need to approximate the flux in energy, it does not account for spatial self-shielding effects throughout a reactor core. This thesis replaces the multi-level framework in place of a full-core \ac{MC} calculation which simultaneously accounts for all energy and spatial effects with a single simulation of the complete heterogeneous geometry.

This work required the development of a ``simulation triad'' encompassing three primary simulation codes. The OpenMC Monte Carlo code was utilized to generate multi-group cross sections on high-spatial-fidelity tally meshes. Second, the \ac{MGXS} were used by the OpenMOC code for deterministic multi-group transport calculations. Finally, the OpenCG library enabled the processing and transfer of tally data on combinatorial geometry meshes between OpenMC and OpenMOC. The simulation triad directly modeled all energy and spatial self-shielding effects with a single full-core OpenMC calculation of the complete heterogeneous geometry to generate \ac{MGXS} for use in OpenMOC.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Approximation Error in Multi-Group Methods}
\label{subsec:chap12-approx-error}

This thesis investigated approximation error present in multi-group solutions even when the ``true'' flux from \ac{MC} is used to collapse cross sections for \ac{MGXS} generation. The case studies presented in Chap.~\ref{chap:biases} quantifed the eigenvalue bias between OpenMC and OpenMOC by separately varying the angular discretization, flat source region discretization and energy group structure while holding all other variables constant. A systematic bias on the order of -300 \ac{pcm} was demonstrated for a representative 2D \ac{PWR} fuel pin cell with converged angular and spatial discretization schemes and 70-group cross sections. The iso-in-lab scattering feature was employed in OpenMC to enable direct comparisons with OpenMOC which assumes an isotropic scattering source, but this only mitigated the bias by approximately 100 \ac{pcm}. The remaining -200 \ac{pcm} was shown to be caused by over-predictions of U-238 capture rates in resonance energy groups. Furthermore, as the energy group structures were refined, the errors were magnified for those energy groups encompassing the three lowest lying U-238 capture resonances.

%-Surprisingly, the bias grew in magnitude (but decreased in value) with more energy groups.
%-the eigenvalue bias varied substantially with the \ac{FSR} discretization, but was invariant to the spatial tally mesh used to generate \ac{MGXS}. 
%-largest for interior zones of fuel pin, smallest for outer rim of fuel pin nearest to the clad/moderator

In collaboration with Gibson~\cite{gibson2016thesis}, the U-238 capture rate errors and resulting eigenvalue bias were demonstrated to be the result of the flux separability approximation (Sec.~\ref{subsec:chap2-angle}) which permits the use of constant-in-angle \ac{MGXS}. In particular, it was shown that the flux separability approximation is not generally valid for U-238 capture since the angular neutron flux leaving a fuel pin is much more self-shielded in resonance groups than it is for the neutron flux entering the fuel pin from the moderator. Since the angular dependence of \ac{MGXS} is not typically modeled in deterministic multi-group transport codes, an equivalence scheme is needed to correct for the loss of angular information when cross sections are collapsed with the scalar rather than the angular flux. 

Chap.~\ref{chap:sph} investigated the use of SuPerHomog\'{e}n\'{e}isation (SPH) factors as one possible equivalence scheme to enforce reaction rate preservation between OpenMC and OpenMOC. The \ac{SPH} factor approach uses a reference fixed source to correct the total \ac{MGXS} to preserve reaction rates between fine and coarse mesh methods. The \ac{SPH} factors systematically eliminated the few percent reaction rate errors in U-238 resonance groups, and correspondingly reduced the eigenvalue bias from -200 \ac{pcm} to approximately 10 \ac{pcm}. In particular, the \ac{SPH} factors reduced the total \ac{MGXS} in resonance groups by 1 -- 3\% to resolve errors of the same magnitude in each of the lowest lying U-238 capture resonance groups. Notwithstanding these results, it is unclear if a generalizable scheme based upon \ac{SPH} factors may be used to correct for the flux separability approximation. Future work should further investigate equivalence methods which adequately preserve reaction rates in fine-mesh transport methods with \ac{MC}-generated \ac{MGXS}.

%-depending on energy group structure and \ac{FSR} discretization

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Clustering of Pin-Wise MGXS}
\label{subsec:chap12-mgxs-clustering}

This thesis explored the dispersion and clustering of pin-wise \ac{MGXS} due to the spatial self-shielding spectral effects in heterogeneous single assembly benchmarks, 2$\times$2 assembly colorsets and a quarter core model of the \ac{BEAVRS} \ac{PWR} geometry. The results in Chap.~\ref{chap:spatial} demonstrated that the population variance of pin-wise \ac{MGXS} increases with the introduction of geometric heterogeneities such as control rod guide tubes (CRGTs), burnable poisons (BPs) and water reflectors. The magnitude of the dispersion depended on the sensitivity of each nuclide, reaction type and energy group to spatial self-shielding effects. Furthermore, the distributions of pin-wise \ac{MGXS} plotted as histograms illustrated the clustering of \ac{MGXS} in fuel pins with similar neighboring heterogeneities, and hence similar spatially self-shielded flux spectra. Although U-235 thermal fission \ac{MGXS} exhibited more clearly defined clusters than U-238 capture \ac{MGXS}, the U-238 capture \ac{MGXS} varied by up to 2.5\% about the population mean while U-235 fission \ac{MGXS} varied by only 1\% about the mean. These results indicate that \ac{MGXS} clustering is more challenging to identify but more important to model for accurate U-238 capture rates than for U-235 fission rates.

%The distributions of pin-wise \ac{MGXS} were highly dependent on the specific reactor configuration.

This thesis performed a series of case studies to investigate the impact of modeling (or neglecting) the clustering of pin-wise \ac{MGXS} due to spatial self-shielding effects\footnote{Although all spatial zones may experience spatial self-shielding, this thesis specifically modeled the impact of spatial self-shielding on MGXS in fissile materials.}. The null and degenerate pin-wise spatial homogenization schemes were designed to quantify the magnitude of the approximation error in deterministic methods that can be resolved by accounting for \ac{MGXS} clustering. Both schemes use a single \ac{MC} calculation of the complete heterogeneous geometry to collapse MGXS with the ``true'' flux. Null homogenization simply assigns all fuel pins to the same \ac{MGXS} cluster and averages all spatial self-shielding effects across the entire geometry. The null scheme makes no effort to account for spatial self-shielding effects experienced by different fuel pins, and computes a single \ac{MGXS} for each fuel enrichment. Degenerate spatial homogenization takes the opposite approach and assigns each fuel pin its own \ac{MGXS}, and is equivalent to modeling each fuel pin as a unique \ac{MGXS} cluster. The degenerate scheme accounts for all spatial self-shielding effects experienced by each instance of each fuel pin throughout a heterogeneous geometry. Although degenerate homogenization is more accurate than null homogenization, it requires many more \ac{MC} particle histories to converge the uncertainties on the \ac{MGXS} tallied separately for each fuel pin.

A series of OpenMOC simulations were performed in Chap.~\ref{chap:quantify} with \ac{MGXS} libraries prepared by the null and degenerate spatial homogenization schemes for six heterogeneous \ac{PWR} benchmarks to measure the impact of \ac{MGXS} clustering on deterministic calculations. In each case, the OpenMOC eigenvalue, pin-wise fission rate and U-238 capture rate predictions were compared with reference OpenMC results\footnote{The case studies were performed for 2-, 8- and 70-group cross sections. The results cited in this chapter correspond to the 70-group calculations since the fine group structure was necessary to resolve OpenMOC's U-238 capture rate predictions to within 2\% of the reference OpenMC results.}. The OpenMOC eigenvalues were within 100 -- 250 \ac{pcm} of the reference OpenMC eigenvalues for all six benchmarks. More importantly, the effect of \ac{MGXS} clustering had no impact on the eigenvalue predictions since null and degenerate homogenization use the same \ac{MC} flux to collapse the cross sections and therefore preserve global reaction rates. The effects of \ac{MGXS} clustering only marginally impacted the OpenMOC fission rates errors which were <2\% for all six benchmarks\footnote{The degenerate homogenization fission rate errors were 5 -- 20\% less than those for null homogenization.}.

The U-238 capture rate errors were much more sensitive to \ac{MGXS} clustering than the fission rates. The degenerate homogenization scheme reduced the errors by 2 -- 4$\times$ with respect to the null scheme for each of the single assembly and colorset benchmarks, approaching the same error magnitude as that observed for the fission rates. The errors for the null scheme were largest for fuel pins near control rode guide tubes and along inter-assembly and assembly-reflector interfaces. The degenerate homogenization scheme reduced the errors for these pins since it accounts for spatial self-shielding spectral effects, such as the additional moderation provided by neighboring control rod guide tubes and/or water reflectors. These results indicate that the U-238 capture rate errors in deterministic multi-group calculations of \acp{PWR} are largely dominated by the approximation(s) made to model pin-wise \ac{MGXS} clustering.

A large fraction of the fissions that occur in \ac{LWR} fuel at the end-of-life occur in the Pu-239 that is bred from U-238 capture reactions. As a result, accurate, high-spatial-fidelity fission rate predictions are limited by the accuracy of the U-238 capture rate predictions in burn-up calculations. The results presented in this thesis underscore the importance of modeling \ac{MGXS} clustering in order to predict Pu-239 production and therefore fission rates over time. This is important not only for \acp{LWR}, but also for advanced reactor concepts that are designed to convert sizable amounts of U-238 to Pu-239 for consumption. In general, \ac{MGXS} clustering is important to model in reactors with a complex configuration of absorbing (\textit{e.g.}, control) and/or moderating materials and relatively short neutron mean free paths (\textit{i.e.}, thermal reactors) such that geometric heterogeneities shield the localized flux throughout the reactor\footnote{\ac{MGXS} clustering may be less important for fast spectrum reactors with large neutron mean free paths since the local flux is relatively insensitive to spatial self-shielding spectral effects.}.

%In particular, \ac{MGXS} clustering is an important phenomenon to model for advanced reactors with relatively short neutron mean free paths (\textit{i.e.}, thermal reactors) such that geometric heterogeneities shield the localized flux to varying degrees throughout the reactor.

%These results are important since U-238 capture rates must be accurately calculated to predict Pu-239 production over time. 

%-degenerate scheme ``smooths'' U-238 capture rates (i.e., reduces largest errors)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Pin-Wise Spatial Homogenization Schemes}
\label{subsec:chap12-homogenization-schemes}

Although the degenerate scheme greatly reduces U-238 capture rate errors by accounting for \ac{MGXS} clustering, it is computationally expensive to converge the \ac{MC} tallies since the particle track densities in each spatial tally zone is quite small. This thesis developed two new pin-wise spatial homogenization schemes which aim to strike a balance between accuracy and computational efficiency by accounting for \ac{MGXS} clustering to accelerate the convergence of the \ac{MGXS} tallies in each fine-spatial-mesh tally zone. The two new schemes are motivated by the idea that fuel pins with similar neighboring heterogeneities will have similar microscopic \ac{MGXS}. In particular, these schemes aim to approach the accuracy of the degenerate scheme by accounting for spatial self-shielding effects, while simultaneously approaching the \ac{MC} convergence of the null scheme by homogenizing over as many spatial tally zones (\textit{i.e.}, fuel pins) as possible.

%-need to homogenize across many fuel pins to reduce the MGXS statistical uncertainties and batchwise deviations

This thesis proposes both engineering-based clustering and statistical clustering methods to accelerate the convergence of full-core \ac{MC} calculations for \ac{MGXS} generation. Local Neighbor Symmetry (LNS) spatial homogenization (Chap.~\ref{chap:spatial}) is an engineering-based approach which clusters \ac{MGXS} based on a nearest neighbor analysis of the fuel pins in a combinatorial geometry. The \ac{LNS} scheme is akin to geometric templates employed by some lattice physics codes to predict which groupings of fuel pins are likely to experience similar spatial self-shielding effects and hence have similar \ac{MGXS}. The MGXS are homogenized from ``noisy'' \ac{MC} tally data across all pins within the same \ac{LNS} grouping. Inferential \ac{MGXS} (\textit{i}\ac{MGXS}) spatial homogenization (Chap.~\ref{chap:unsupervised}) uses statistical clustering algorithms to infer \ac{MGXS} clusters directly from ``noisy'' \ac{MC} tally data. Unlike the \ac{LNS} scheme, the \textit{i}\ac{MGXS} has now knowledge of a reactor's geometric or materials configuration and instead relies on unsupervised machine learning techniques to determine which fuel pins to cluster in spatial homogenization zones. The \textit{i}\ac{MGXS} scheme is a multi-stage data processing pipeline and includes feature extraction, feature selecion, dimensionality reduction, predictor training, model selection and spatial homogenization stages. Both \ac{LNS} and \textit{i}\ac{MGXS} homogenization schemes attempt to model \ac{MGXS} clustering with fewer materials than degenerate homogenization in order accelerate the \ac{MC} tally convergence rate by homogenizing \ac{MGXS} across many fuel pins.

%The \textit{i}\ac{MGXS} scheme can flexibly accommodate arbitrary core heterogeneities better than heuristic approaches like \ac{LNS} which must be customized for particular core geometries. In addition, the \textit{i}\ac{MGXS} scheme accelerates the convergence rate of MGXS tallied with MC with respect to the degenerate and \ac{LNS} schemes since it homogenizes MC tallies across many more fuel pins.

% However, the \ac{LNS} algorithm fails to predict spatial self-shielding effects in arbitrary core geometries, such as those that occur at assembly-assembly and assembly-reflector interfaces. These shortcomings motivate the need for an unsupervised approach to accurately and scalably predict MGXS clustering.

The efficacy of the \ac{LNS} and \textit{i}\ac{MGXS} schemes to identify \ac{MGXS} clusters was evaluated for each of the six heterogneous \ac{PWR} benchmarks. The ``clustered geometries'' for the \ac{LNS} scheme illustrate the method's ability to distinguish fuel pins with neighboring \acp{CRGT} and/or \acp{BP}, but its inability to distinguish fuel pins at the interfaces with neighboring assemblies, reflectors or baffles. In contrast, the \textit{i}\ac{MGXS} scheme distinguished pins with similar neighboring \acp{CRGT} and/or \acp{BP}, and subsequently distinguished pins along interfaces into unique clusters. In general, the clustered geometries indicate that \textit{i}\ac{MGXS} scheme can flexibly accommodate arbitrary core heterogeneities better than heuristic approaches like \ac{LNS} which must be customized for particular core geometries.

A series of OpenMOC simulations were performed with \ac{MGXS} libraries prepared by the \ac{LNS} (Chap.~\ref{chap:spatial}) and \textit{i}\ac{MGXS} (Chap.~\ref{chap:results}) spatial homogenization schemes. As expected, the eigenvalues predicted by both schemes were nearly identical (to within 10 \ac{pcm}) since both schemes preserve global reaction rates. Although fission rates are only marginally impacted by \ac{MGXS} clustering, the predictions with the \ac{LNS} and \textit{i}\ac{MGXS} schemes were very nearly as accurate as those for the degenerate scheme. Most importantly, the U-238 capture rate errors approached those for the degenerate scheme to varying degrees for both schemes. The \ac{LNS} scheme performed as well the degenerate scheme for the single assembly benchmarks, but failed to systematically reduce the largest errors in the pins along inter-assembly and assembly-reflector interfaces. The \textit{i}\ac{MGXS} scheme largely reduced the U-238 capture rate errors with just a few clusters with relatively diminishing returns for more clusters. The \textit{i}\ac{MGXS} scheme required more materials (\textit{i.e.}, clusters) than \ac{LNS} to achieve the same accuracy for single assembly benchmarks. However, \textit{i}\ac{MGXS} outperformed \ac{LNS} for those benchmarks with inter-assembly and assembly-reflector interfaces, since it assigned unique \ac{MGXS} to the fuel pins along the interfaces to account for the local spatially self-shielded flux spectra.

In addition, the simulations were performed to quantify the number of \ac{MC} particle histories required to sufficiently converge the \ac{MGXS} for stable OpenMOC solutions with each pin-wise spatial homogenization scheme. The convergence analysis was performed for the single assembly and 2$\times$2 colorset benchmarks, but was not performed for the quarter core \ac{BEAVRS} model due to computational constraints. The eigenvalues for the null, degenerate, \ac{LNS} and \textit{i}\ac{MGXS} schemes converged to the same value with approximately 10$^{8}$ particle histories. As expected, the pin-wise U-238 capture rates converged in accordance with the number of clusters used in each pin-wise spatial homogenization scheme. In particular, the capture rates for the null scheme quickly converged with only 10$^{6}$ histories, but were still not yet fully converged for degenerate homogenization even with 10$^{9}$ histories. In contrast, the \ac{LNS} and \textit{i}\ac{MGXS} schemes converged faster than the degenerate scheme since they averaged the \ac{MGXS} tallied for the pins assigned to each cluster. Furthermore, both schemes converged faster than the statistical uncertainties of the corresonding reference OpenMC calculation. The magnitude of the acceleration achieved by both schemes depends on both the number of clusters required to meet the desired level of accuracy as well as the number of fuel pins assigned to each cluster\footnote{The error convergence is limited by the number of pins assigned to the smallest \ac{MGXS} cluster. The clusters of pins adjacent to the baffle/reflector -- which exhibited the largest U-238 capture rate errors -- comprised the smallest clusters in each benchmark were the most limiting for the U-238 capture rate convergence.}. The mean capture rate rate errors converged 5 -- 20$\times$ faster than the degenerate scheme or the OpenMC reference solution uncertainties for the benchmarks considered in this thesis.

%, though more histories may be needed for larger geometries (\textit{e.g.}, \ac{BEAVRS})

% -but with so few pins assigned to the cluster, the track density and therefore acceleration is minimal
% The eigenvalues fluctuated within 500 \ac{pcm} of the converged mean for fewer histories.

These results demonstrate a path forward to generate \ac{MGXS} with reactor agnostic \ac{MC} for computationally efficient deterministic transport codes. This thesis replaced traditional multi-level \ac{MGXS} generation schemes with \ac{MC} calculations of the complete heterogeneous geometry to generate reactor agnostic \ac{MGXS} in a single step. Engineering-based and statistical clustering algorithms were developed to model the clustering of pin-wise \ac{MGXS} to reduce the U-238 capture rate errors while simultaneously accelerating the convergence of the tallied \ac{MGXS}. The \ac{LNS} and \textit{i}\ac{MGXS} schemes enabled deterministic reactor physics simulations to produce accurate results from \ac{MGXS} generated by \ac{MC} faster than would be possible with a direct calculation with \ac{MC}. Furthermore, the \textit{i}\ac{MGXS} scheme was shown to be advantageous over geometric heuristic approaches such as \ac{LNS} which must be highly customized for specific types of core geometries.

%  -\ac{LNS} requires 400+ of materials to model 12,000+ fuel pin instances in \ac{BEAVRS}
%    -analysis of geometry is based on cell/universe/lattice IDs

%-iMGXS accounts for spatial self-shielding spectral effects without engineering heuristics based on the reactor core configuration.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Contributions}
\label{sec:chap12-contributions}

-include use of \ac{SPH} factors
-discuss replacing multi-level scheme
-itemize which approximation errors were investigated
  -MOC: angular discretization, \ac{FSR} discretization, energy discretization
  -MGXS: isotropic in lab approximation, energy discretization, spatial homogenization zones (by FSR within each pin, across many ``clustered pins'')
-have bullet specifically for pin-wise spatial homogenization schemes
 -include individual sub-bullets for null, degenerate, LNS and iMGXS

\begin{emphbox}
\begin{itemize}
\item Generated MGXS with a single MC simulation of a complete heterogeneous reactor geometry for use fine-mesh deterministic transport calculations.
\item Implemented a simulation triad that generated MGXS with OpenMC, used MGXS in deterministic OpenMOC calculations, and transferred MGXS between codes and built clustered geometries with OpenCG.
\item Developed LNS and iMGXS pin-wise spatial homogenization schemes to account for spatial self-shielding effects on the MGXS in each fuel pin while simultaneously accelerating MC tally convergence.
\item Quantified approximation error between reference OpenMC and deterministic OpenMOC calculations of the eigenvalues, pin-wise fission rates and U-238 capture rates for each homogenization scheme.
\item Demonstrated that LNS and iMGXS spatial homogenization schemes require fewer MC histories to generate MGXS and converge deterministic calculations to a given accuracy than an equivalent MC calculation.
\end{itemize}
\end{emphbox}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Future Work}
\label{sec:chap12-future-work}

%-focus on model selection criteria in future work section

first paragraph: motivation and outline
-this is an exploratory thesis
  -generate MGXS with MC for fine-mesh transport
  -single-step process
  -diagnose approx. error
-thesis identified many challenges and opportunities
-this section itemizes the author's assessment of what should be done and in what order
  -Sec.~\ref{subsec:further-imgxs} - improve \textit{i}\ac{MGXS}
  -Sec.~\ref{subsec:improve-mc-methods} - improve \ac{MC} methods to generate \ac{MGXS}

This thesis identified several issues which must be investigated in the future in order for \textit{i}MGXS to be useful in a production code setting. First, a systematic evaluation of the types of features, as well as algorithms for dimensionality reduction and clustering, which may be used in \textit{i}MGXS should be performed to better understand their impact on the resulting clustered geometry. A future study should also score each configuration of the \textit{i}MGXS data processing pipeline based on how many MC particle histories each scheme requires to accurately identify MGXS clusters from ``noisy'' MC tally data. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Further Evaluation of the \textit{i}MGXS Scheme}
\label{subsec:chap12-further-imgxs}

first paragraph: motivate and outline
-this work only scratched the surface of what is possible
-Sec.~\ref{subsubsec:imgxs-noisy-mc-data} should consider using 
-Sec.~\ref{subsubsec:optimize-imgxs} investigate various configurations of the \textit{i}MGXS scheme
-Sec.~\ref{subsubsec:optimize-simulation-triad} speeding up the various components of the simulation triad

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Evaluate \textit{i}MGXS Scheme with Noisy Tally Data}
\label{subsubsec:chap12-imgxs-noisy-mc-data}

first paragraph: 
-recall that convergence results in Sec.~\ref{sec:chap11-converge} used ``fully converged'' MC tally data
  -gave an upper bound for how quickly results converge in best case scenario
-what: repeat convergence studies with noisy ``MC'' tally data from statepoints at each batch
-why:  need to determine how quickly OpenMOC results stabilize 
-what would we expect??
  -errors will likely be larger for fewer batches
    -fuel pins more likely to be assigned to the wrong clusters
  -eventually errors will asympotically approach those shown for the upper bound
  -studies needed to determine how quickly the clustering predictions converge
-this would revise our estimates for the expected runtime in Sec.~\ref{subsec:chap11-runtimes}
  -wouldn't reduce but could potentially increase the runtime estimates
  -also possible that clustering predictions ``converge'' or ``stabilize'' before the OpenMOC solutions
-should also perform convergence studies with BEAVRS full core
-Score iMGXS configurations by number of MC histories needed to accurately identify MGXS clusters from ``noisy'' MC tally data

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Optimize the \textit{i}MGXS Data Processing Pipeline}
\label{subsubsec:chap12-optimize-imgxs}

first paragraph: 
-Systematically evaluate various configurations of the iMGXS data processing pipeline:
-Feature extraction – Engineer new, better features?
-Feature selection – Develop techniques to select “best” features?
-Dimensionality reduction – Use fewer features for clustering?
-Clustering models – Which use the fewest clusters to reduce errors?
-Model selection – Which method best correlates with error reduction? none of them robustly works for my case studies!
-evaluate each with respect to score with noisy data Sec.~\ref{subsubsec:imgxs-noisy-mc-data}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Optimize Computational Performance of Simulation Triad}
\label{subsubsec:chap12-optimize-simulation-triad}

first paragraph:
-speed up OpenMOC full core: \\
  -find a way use quarter assembly CMFD mesh \\
    -use mesh only over fissile zones??
  -linear source to reduce number of spatial zones \\
  -vectorize transport solver over energy groups \\
  -3D \ac{MOC}
-speed up OpenMC:
  -particle tracking times in Tab.~\ref{table:chap11-openmc-rates} were 3$\times$ slower w/ tallies
  -numerous lingering issues, including: 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Improved Methods to Generate MGXS with MC}
\label{subsec:chap12-improve-mc-methods}

first paragraph: motivation
-recall that relatively little work to date to use \ac{MC} to generate \ac{MGXS} for fine-mesh transport codes as compared to coarse mesh diffusion codes
-methods lie along two axes:
  -improve tally efficiency (first one)
  -improve equivalence b/w \ac{MC} and multi-group deterministic codes (last three)
-Sec.~\ref{subsubsec:tally-estimators} to improve tally estimators
-Sec.~\ref{subsubsec:transport-mgxs} to model anisotropic scattering
-Sec.~\ref{subsubsec:angular-dependent-mgxs} equivalence method for scalar flux-weighted \ac{MGXS}
-Sec.~\ref{subsubsec:multi-physics-mgxs} multi-physics feedback in \ac{MGXS}

Future work should also consider employing \textit{i}MGXS in calculations with thermal-hydraulic feedback and nuclide depletion where the moderator density, fuel temperature and burnup will be needed as features to predict MGXS clustering. In addition, new methods must be developed to compute transport-corrected MGXS with MC which appropriately account for anisotropic scattering, thereby eliminating the isotropic in lab scattering approximations used throughout this work. Finally, this thesis may serve as inspiration to employ machine learning algorithms to automate the time-consuming process of selecting reduced energy group structures and their optimal energy group boundaries for MGXS.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Improved Reaction Rate Tally Estimators}
\label{subsubsec:chap12-tally-estimators}

first paragraph: motivate and outline problem
-recall mixture of analog and track-length tally estimators employed to generate \ac{MGXS} with OpenMC in Sec.~\ref{subsubsec:chap3-tally-types-summary}
  -analog estimators used for group constants which depend on the outgoing energy
    -i.e., scattering matrix and fission spectrum
  -all other constants use more efficient track-length tally estimators
-recall separation between eigenvalues in Sec.~\ref{subsec:chap11-eigenvalue-converge} for few particle histories
  -all clustering algorithms eventually converge with enough particle histories
  -hypothesize that gap due to rxn rate imbalance (not preserved) due to mixture of tally estimators  
  -improved estimator may improve convergence to identical eigenvlaue

second paragraph: possible solutions
-cite Nelson NDPP~\cite{nelson2014improved} as one option
-simple heuristics may be employed for hydrogeneous systems to greatly improve tallying efficiency

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Account for Anisotropic Scattering}
\label{subsubsec:chap12-transport-mgxs}

first paragraph: motivate and outline problem
-recall use of OpenMC's iso-in-lab scattering feature in Sec.~\ref{subsec:chap4-iso-in-lab}
  -enable ``apples-to-apples'' comparisons between OpenMC and OpenMOC
-recall impact on pin-wise reaction rates
  -compare pin-wise fission and U-238 capture rate distributions:
    -with iso-in-lab scattering: Figs.~\ref{fig:chap7-fiss-rates-full-core} and~\ref{fig:chap7-capt-rates-full-core}
    -with anisotropic scattering: Fig.~\ref{fig:benchmarks-beavrs-aniso}
  -iso-in-lab approx. causes fission rates to peak at approx. 2.3 -- 2.9 as compared to 1.5 -- 1.6
    -due to artificial scattering of neutrons from reflector back into core
    -reaction rates peak in assemblies near corners of the core nearest to the reflector
-need to model anisotropic scattering in multi-group deterministic code to solve ``correct'' or physical problem

second paragraph: possible solutions
-use full anisotropic scattering matrices in MOC
  -unclear what expansion order is necessary
  -this is the most theoretically rigorous approach
  -downside is that this is computationally expensive
    -more expensive to 1) compute scattering source and 2) tally flux moments
  -cite Nelson's work???
-improved transport cross sections
  -recall Sec.~\ref{subsec:chap2-transport-corr}
  -modify the total cross section in an attempt to produce an equivalent solution 
  -advantage is that the computational burden is no larger than it is currently
  -cite Liu's work???

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Equivalence Method for Angular-Dependent MGXS}
\label{subsubsec:chap12-angular-dependent-mgxs}

first paragraph: motivate and outline problem
-recall eigenvalue bias in simple 1D slab and 2D fuel pin benchmarks in Chap.~\ref{chap:biases}
-shown to be the result of errors in U-238 capture resonance groups
  -over-predicts capture by up to 2\% in group 27/70 which contains the 6.67 eV resonance 
  -trend was exacerbated for smaller energy groups
-cite nate's thesis~\cite{gibson2016thesis}
  -effect is the result of using the scalar rather than the angular flux to collapse \ac{MGXS}
-recall use of \ac{SPH} factors to correct this in Chap.~\ref{chap:sph}

second paragraph: possible solutions
-recall \ac{SPH} factors
  -equivalence factor use to preserve reaction rates in fissile zones given a fixed source in each region
  -\ac{SPH} factors are intrinsically coupled to spatial discretization
  -\ac{SPH} factors does not distinguish between sources of approximation error, and simply tries to preserve a reference reaction rate solution
    -all errors are indiscriminately treated with \ac{SPH}
      -angular, spatial, energy discretization, scattering kernel, etc. 
  -why it is challenging: 
    -requires knowledge of the fixed sources
    -is iterative and hence computationally expensive
  -possible changes: may be able to tabulate a set of \ac{SPH} factors for a specific energy group structure and spatial discretization
  -unclear how much the factors depend on enrichment, spatial discretization, etc.
-Consistent-P or BHS~\cite{bell1967transport}
  -expand collision term with Legendre moments, transfer to scattering kernel
-angular-dependent \ac{MGXS}
  -separate \ac{MGXS} for different angles in deterministic code
  -angular dependence is intrinsically coupled to spatial discretization
  -why it is challenging:
    -burdensome to track extra data in deterministic code
    -burdensome to tally extra data in \ac{MC}
    -must \textit{a priori} know or approximate angular dependence and its relationship with spatial mesh
  -possible changes: ``jump'' conditions, i.e. coarse angular discretization
    -still requires some knowledge of spatial discretization mesh

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Account for Multi-Physics Feedback in MGXS}
\label{subsubsec:chap12-multi-physics-mgxs}

first paragraph: motivate and outline problem
-all calculations here were for steady-state scenarios with fresh \ac{PWR} fuel without T-H feedback
-\ac{MC} calculations used to generate \ac{MGXS} in future may:
  -model temperature-dependent cross sections (i.e., multipole)
  -model moderator density and/or temperature gradients
  -model fuel burnup with unique appropriate isotopic vectors in each fuel pin

second paragraph: possible solutions
-may be possible to use new features to model fuel burnup
  -i.e., fuel temperature, density of nearby moderator (T-H calcs), fuel burnup (depletion calcs)
-may be able to train machine learning regression models to predict \ac{MGXS} with these features
  -i.e., decision tree or support vector regression
  -challenging since this will not necessarily preserve global reactivity
    -must use integrated flux and reaction rates within fuel pin of interest rather than predicted \ac{MGXS} itself

%-multi-physics applications: moderator density, fuel temperature, burnup, etc. as features \\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Inspiration for New Research Directions}
\label{subsec:chap12-inspiration}

first paragraph: research may inspire new areas of research
-ML might be useful in other simulation application areas
  -large scale parameter selection for simulations
  -replace engineering / human judgement with data-informed decision-making
    -more flexible/extensible and accurate for parameter regimes (i.e., reactor designs) for which there may be little prior experience / heuristics
-could be closely related topics, such as choosing energy group boundaries
  -machine learning to optimize energy group structures \\
    -can \textit{i}MGXS reduce the number of necessary energy groups?? \\
-or could be in very different disciplines where a similar tradeoffs are made between simulation accuracy and speed